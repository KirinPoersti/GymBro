{% extends "base.html" %}
{% block wrap_class %}wrap--wide{% endblock %}
{% block header %}{% endblock %}

{% block content %}
<div class="topbar">
  <div class="brand-block">
    <div class="brand">üèãüèøGymBro</div>
    <div class="welcome">Hi, {{ session['username'] }} üëã</div>
  </div>
  <div class="actions">
    <a class="icon-btn" title="Profile" href="{{ url_for('profile') }}">üë§</a>
    <a class="icon-btn" title="Settings" href="{{ url_for('settings') }}">‚öôÔ∏è</a>
    <a class="logout" href="{{ url_for('logout') }}">Logout</a>
  </div>
</div>

<div class="monthbar">
  <a href="{{ url_for('dashboard', y=prev_y, m=prev_m) }}">‚Üê Previous</a>
  <div class="monthtitle">{{ year }} ‚Äì {{ "%02d"|format(month) }}</div>
  <a href="{{ url_for('dashboard', y=next_y, m=next_m) }}">Next ‚Üí</a>
</div>

<div class="wkhdr">
  {% for n in ["MON","TUE","WED","THU","FRI","SAT","SUN"] %}
    <div class="cell head">{{ n }}</div>
  {% endfor %}
</div>

<div class="grid">
  {% for d in grid %}
    {% set dim = (d.month != month) %}
    {% set is_today = (d == today) %}
    {% set has_workout = d.isoformat() in workout_dates %}
    {% set is_low = d.isoformat() in lowcarb_dates %}
    {% set is_high = d.isoformat() in highcarb_dates %}
    <a class="cell day
              {% if dim %} dim{% endif %}
              {% if is_today %} today{% endif %}
              {% if is_low %} lowcarb{% endif %}
              {% if is_high %} highcarb{% endif %}"
       href="{{ url_for('day_view', d=d.isoformat()) }}">
      <div class="num">{{ d.day }}</div>
      {% if has_workout %}
        <div class="tick" title="Workout logged">‚≠ïÔ∏è</div>
      {% endif %}
    </a>
  {% endfor %}
</div>

<style>
  .cell.head{
    pointer-events: none;     
    transition: none;
    align-items:center; justify-content:center; font-weight:700; height:44px;
    background:#ca2314;
    color:#fff;
    border:none;
    box-shadow:
      0 1px 2px rgba(0,0,0,.10),
      0 6px 18px rgba(0,0,0,.18);
  }

  .cell.day.lowcarb { background: #ff864e; }  
  .cell.day.highcarb { background: #55ff8e; }

  .cell.day .num { font-weight:700; font-size:14px; color:#111; }

  .cell.day .tick{
    position:absolute; right:8px; bottom:10px;
    font-weight:400; font-size:50px; line-height:1;
  }

  .cell.day.today{
    outline: none;          
    outline-offset: 0;    
    box-shadow:
      inset 0 0 0 3px rgba(122,167,255,1),
      0 2px 6px rgba(0,0,0,.10),
      0 14px 32px rgba(0,0,0,.16);
  }

  .topbar {
    display: flex;
    align-items: flex-start;
    justify-content: space-between;
    margin-bottom: 14px;
  }

  .brand-block {
    display: flex;
    flex-direction: column;
    align-items: flex-start;   
    margin-top: -45px;          
    margin-left: 4px;         
  }
  .brand {
    font-size: 34px;
    text-decoration: none;
    color: #111;
    line-height: 1;           
  }
  .welcome { font-size: 22px; margin-top: 4px; color: #333; }

  .actions { display: flex; align-items: center; gap: 10px; }

  .actions .icon-btn,
  .actions .logout {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    padding: 8px 16px;
    min-height: 40px;
    line-height: 1;
    font-size: 15px;
    color: #111;
    border: none;
    border-radius: 14px;
    text-decoration: none;

    background: rgba(255, 255, 255, 0.15);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);

    box-shadow:
      0 1px 2px rgba(0,0,0,.08),
      0 8px 24px rgba(0,0,0,.10);
    transition: box-shadow .2s ease, transform .2s ease, background .2s ease;
  }
  .actions .icon-btn:hover,
  .actions .logout:hover {
    transform: translateY(-1px);
    background: rgba(255, 255, 255, 0.25);
    box-shadow:
      0 2px 6px rgba(0,0,0,.10),
      0 14px 32px rgba(0,0,0,.16);
  }
  .actions .icon-btn:focus-visible,
  .actions .logout:focus-visible {
    outline: none;
    box-shadow:
      inset 0 0 0 3px rgba(122,167,255,1),
      0 2px 6px rgba(0,0,0,.10),
      0 14px 32px rgba(0,0,0,.16);
  }

  .icon-btn--square { padding: 8px; min-width: 40px; min-height: 40px; }
  .icon-btn img, .icon-btn svg { display: block; }

  .monthbar { display:flex; align-items:center; justify-content:space-between; margin:6px 0 10px; }
  .monthtitle { font-weight:700; }

  .wkhdr { display:grid; grid-template-columns:repeat(7,1fr); gap:10px; margin-bottom:8px; }

  .grid { display:grid; grid-template-columns:repeat(7,1fr); grid-auto-rows:94px; gap:10px; }


  .cell {
    border:none;
    border-radius:20px;
    background: rgba(255,255,255,0.15);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);

    display:flex; align-items:flex-start; justify-content:flex-start;
    padding:8px; text-decoration:none; color:#111; position:relative;

    box-shadow:
      0 1px 2px rgba(0,0,0,.08),
      0 8px 24px rgba(0,0,0,.10);
    transition: box-shadow .2s ease, transform .2s ease, background .2s ease;
  }
  .cell:hover {
    transform: translateY(-1px);
    background: rgba(255,255,255,0.25);
    box-shadow:
      0 2px 6px rgba(0,0,0,.10),
      0 14px 32px rgba(0,0,0,.16);
  }

  .cell.day .num { font-weight:700; font-size:14px; }
  .cell.day.dim { opacity:.45; }
  .cell.day.today { outline:5px solid #30ff98; outline-offset:-3px; }

  @media (max-width:860px){
    .wrap--wide { max-width:100%; }
    .grid { grid-auto-rows:80px; }
  }
</style>
{% endblock %}
